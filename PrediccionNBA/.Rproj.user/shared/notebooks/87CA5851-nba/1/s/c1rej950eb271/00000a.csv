"0","relweights <- function(fit,...){"
"0","R <- cor(fit$model)"
"0","nvar <- ncol(R)"
"0","rxx <- R[2:nvar, 2:nvar]"
"0","rxy <- R[2:nvar, 1]"
"0","svd <- eigen(rxx)"
"0","evec <- svd$vectors"
"0","ev <- svd$values"
"0","delta <- diag(sqrt(ev))"
"0","lambda <- evec %*% delta %*% t(evec)"
"0","lambdasq <- lambda ^ 2"
"0","beta <- solve(lambda) %*% rxy"
"0","rsquare <- colSums(beta ^ 2)"
"0","rawwgt <- lambdasq %*% beta ^ 2"
"0","import <- (rawwgt / rsquare) * 100"
"0","import <- as.data.frame(import)"
"0","row.names(import) <- names(fit$model[2:nvar]) "
"0","names(import) <- ""Weights"""
"0","import <- import[order(import),1, drop=FALSE]"
"0","dotchart(import$Weights, labels=row.names(import),"
"0","  xlab=""% of R-Square"", pch=19,"
"0","  main=""Relative Importance of Predictor Variables"", "
"0","  sub=paste(""Total R-Square="", round(rsquare, digits=3)), ...)"
"0","return(import)"
"0","}"
"0",""
"0","#players <- as.data.frame(players.x77[,c(""nba_draftnumber"", ""age"", ""g"", ""mp"", ""per"", ""threepar"", ""orb"", ""trb"", ""usg"", ""ws"", ""obpm"")])"
"0","fit <- lm(salary ~ nba_draftnumber + age + g + mp + per + "
"0","    threepar + orb + trb + usg + ws + obpm, data=nba)"
"0","relweights(fit, col=""blue"")"
